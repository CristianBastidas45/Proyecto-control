	CBLOCK .57
	ENDC
	#DEFINE	RS  		PORTE,2
	#DEFINE	RW  		PORTE,1
	#DEFINE	EN	  	PORTE,0
	#DEFINE	PTOLCD  	PORTD
ENVIA_COMANDO
       MOVWF    PTOLCD
       BCF	   RS
       BSF	   EN
       CALL	   RETARDO_2MS
       BCF	   EN
	RETURN

LCD_INICIALIZA
	BSF	STATUS,RP0
	BCF	STATUS,RP1
	BCF	RS
	BCF	RW
	BCF	EN
	CLRF     PTOLCD
	BCF	STATUS,RP0
	CALL	RETARDO_20MS
	
	BCF	RS
	BCF	RW
	MOVLW B'00110000'
	CALL	ENVIA_COMANDO
	
	CALL	RETARDO_5MS
	
	BCF	RS
	BCF	RW
	MOVLW B'00110000'
	CALL	ENVIA_COMANDO
	
	CALL	RETARDO_100MICROS
	
	BCF	RS
	BCF	RW
	MOVLW B'00110000'
	CALL	ENVIA_COMANDO
	
	BCF	RS
	BCF	RW
	MOVLW B'00111000' ; LCD 2 FILAS, 5X7, 8BITS
	;MOVLW B'001 DL N F * *'
	;DL=1 YA QUE EMPLEA UN BUS DE 8
	;N=0 SI LA LCD ES DE UNA FILA
	;N=1 SI LA LCD ES DE DOS FILAS     OK
	;F=0 SI LA MATRIZ ES DE  5X7           OK
	;F=1 SI LA MATRIZ ES DE  5X10
	CALL	ENVIA_COMANDO
	
	BCF	RS
	BCF	RW
	MOVLW B'00001000'
	CALL	ENVIA_COMANDO
	
	BCF	RS
	BCF	RW
	MOVLW  B'00000001'
	CALL	ENVIA_COMANDO
	
	BCF      RS
	BCF	RW
	MOVLW B'00000111'
	;MOVLW B'000001 I/D   S'
	;S=0 NO DESPLAZA CARACTERES
	;S=1 DESPLAZA CARACTERESLCD_CURSOR_INCREMENTO
	;id=1 iNCREMENTO AUTOMÀTICO D LA POSICION DEL CURSOR
	CALL	ENVIA_COMANDO
	RETURN
	
LCD_BORRA
	BCF      		RS
	BCF    		RW
	MOVLW     	B'00000001'
	CALL		ENVIA_COMANDO
	RETURN
LCD_CURSORINC
	BCF		 RS
	BCF               RW
	MOVLW 	B'00000110'
	CALL		ENVIA_COMANDO
	RETURN
LCD_FILA1
      BCF			RS
      BCF			RW
      MOVLW        B'10000000' ;B7 EN 1 ACCEDE A LA DDRAM;
      ;B6=0 SE ENCUENTRA EN POSICION FILA 1
      CALL		ENVIA_COMANDO
      RETURN
LCD_FILA2
      BCF			RS
      BCF			RW
      MOVLW        B'11000000' ;B7 EN 1 ACCEDE A LA DDRAM;
      ;B6=1 SE ENCUENTRA EN POSICION FILA 2
      CALL		ENVIA_COMANDO
      RETURN
	
LCD_CURSORON
	BCF	RS
	BCF	RW
	MOVLW B'00001111'
	;00001 DCB  
	;c=1 CURSOR VISIBLE
	;B=1 PARPADEA
	;D=1 ENCIENDE DISPLAY
	CALL	ENVIA_COMANDO
	RETURN	

LCD_CARACTER
	MOVWF		PTOLCD
	BCF		RW
	BSF		RS ;CARACTER Y NO COMANDO
	BSF		EN ; HABILITA LCD PARA EJECUTAR ACCION
	CALL		RETARDO_100MICROS ; 40 MICROS
	BCF		EN ;DESHABILITAN LA LCD
	BCF		RS ; PASAN A MODO COMANDO
	RETURN
	